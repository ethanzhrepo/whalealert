<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>URLåŒ¹é…é€»è¾‘æµ‹è¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f8fa;
        }
        
        .container {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #1da1f2;
            margin-bottom: 24px;
        }
        
        .test-section {
            margin-bottom: 32px;
            padding: 16px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .test-case {
            margin-bottom: 16px;
            padding: 12px;
            background: white;
            border-radius: 6px;
            border-left: 4px solid #e1e8ed;
        }
        
        .test-case.pass {
            border-left-color: #17bf63;
        }
        
        .test-case.fail {
            border-left-color: #e0245e;
        }
        
        .test-input {
            font-family: monospace;
            font-size: 12px;
            color: #657786;
            margin-bottom: 8px;
        }
        
        .test-result {
            font-weight: 600;
        }
        
        .test-result.pass {
            color: #17bf63;
        }
        
        .test-result.fail {
            color: #e0245e;
        }
        
        .input-section {
            margin-bottom: 24px;
        }
        
        .input-group {
            margin-bottom: 12px;
        }
        
        label {
            display: block;
            margin-bottom: 4px;
            font-weight: 500;
        }
        
        input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #e1e8ed;
            border-radius: 6px;
            font-size: 14px;
            box-sizing: border-box;
        }
        
        button {
            background: #1da1f2;
            color: white;
            border: none;
            border-radius: 6px;
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
        }
        
        button:hover {
            background: #1991db;
        }
        
        .summary {
            text-align: center;
            padding: 16px;
            background: #e8f5e8;
            border-radius: 8px;
            margin-top: 24px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” URLåŒ¹é…é€»è¾‘æµ‹è¯•</h1>
        
        <div class="input-section">
            <h3>æ‰‹åŠ¨æµ‹è¯•</h3>
            <div class="input-group">
                <label>å½“å‰URL:</label>
                <input type="text" id="currentUrl" placeholder="https://twitter.com/i/lists/123456789">
            </div>
            <div class="input-group">
                <label>é…ç½®çš„åˆ—è¡¨URL:</label>
                <input type="text" id="configuredUrl" placeholder="https://twitter.com/i/lists/123456789">
            </div>
            <button onclick="testManual()">æµ‹è¯•åŒ¹é…</button>
            <div id="manualResult" style="margin-top: 12px;"></div>
        </div>
        
        <div class="test-section">
            <h3>è‡ªåŠ¨æµ‹è¯•ç”¨ä¾‹</h3>
            <div id="testResults"></div>
        </div>
        
        <div id="summary" class="summary" style="display: none;">
            <h3>æµ‹è¯•æ€»ç»“</h3>
            <div id="summaryText"></div>
        </div>
    </div>

    <script>
        // å¤åˆ¶URLåŒ¹é…é€»è¾‘
        function isUrlMatch(currentUrl, configuredUrl) {
            try {
                // ç§»é™¤URLä¸­çš„æŸ¥è¯¢å‚æ•°å’Œç‰‡æ®µæ ‡è¯†ç¬¦è¿›è¡Œæ¯”è¾ƒ
                const cleanCurrentUrl = currentUrl.split('?')[0].split('#')[0];
                const cleanConfiguredUrl = configuredUrl.split('?')[0].split('#')[0];
                
                // ç§»é™¤æœ«å°¾çš„æ–œæ è¿›è¡Œæ¯”è¾ƒ
                const normalizeUrl = (url) => url.replace(/\/$/, '');
                
                const normalizedCurrentUrl = normalizeUrl(cleanCurrentUrl);
                const normalizedConfiguredUrl = normalizeUrl(cleanConfiguredUrl);
                
                // å®Œå…¨åŒ¹é…
                if (normalizedCurrentUrl === normalizedConfiguredUrl) {
                    return true;
                }
                
                // æ£€æŸ¥æ˜¯å¦æ˜¯Twitteråˆ—è¡¨URLçš„å˜ä½“
                const twitterListPattern = /^https?:\/\/(twitter\.com|x\.com)\/(.+)$/;
                const currentMatch = normalizedCurrentUrl.match(twitterListPattern);
                const configuredMatch = normalizedConfiguredUrl.match(twitterListPattern);
                
                if (currentMatch && configuredMatch) {
                    // æå–è·¯å¾„éƒ¨åˆ†è¿›è¡Œæ¯”è¾ƒ
                    const currentPath = currentMatch[2];
                    const configuredPath = configuredMatch[2];
                    
                    // è·¯å¾„å®Œå…¨åŒ¹é…
                    if (currentPath === configuredPath) {
                        return true;
                    }
                }
                
                return false;
            } catch (error) {
                console.error('URLåŒ¹é…æ£€æŸ¥å¤±è´¥:', error);
                return false;
            }
        }

        // æµ‹è¯•ç”¨ä¾‹
        const testCases = [
            // åº”è¯¥åŒ¹é…çš„æƒ…å†µ
            {
                current: 'https://twitter.com/i/lists/123456789',
                configured: 'https://twitter.com/i/lists/123456789',
                expected: true,
                description: 'å®Œå…¨ç›¸åŒçš„URL'
            },
            {
                current: 'https://twitter.com/i/lists/123456789?param=value',
                configured: 'https://twitter.com/i/lists/123456789',
                expected: true,
                description: 'å½“å‰URLæœ‰æŸ¥è¯¢å‚æ•°'
            },
            {
                current: 'https://twitter.com/i/lists/123456789',
                configured: 'https://twitter.com/i/lists/123456789/',
                expected: true,
                description: 'é…ç½®URLæœ‰æœ«å°¾æ–œæ '
            },
            {
                current: 'https://x.com/i/lists/123456789',
                configured: 'https://twitter.com/i/lists/123456789',
                expected: true,
                description: 'ä¸åŒåŸŸåä½†ç›¸åŒè·¯å¾„'
            },
            {
                current: 'https://twitter.com/username/lists/listname',
                configured: 'https://twitter.com/username/lists/listname',
                expected: true,
                description: 'ç”¨æˆ·è‡ªå®šä¹‰åˆ—è¡¨'
            },
            
            // ä¸åº”è¯¥åŒ¹é…çš„æƒ…å†µ
            {
                current: 'https://twitter.com/i/lists/123456789',
                configured: 'https://twitter.com/i/lists/987654321',
                expected: false,
                description: 'ä¸åŒçš„åˆ—è¡¨ID'
            },
            {
                current: 'https://twitter.com/home',
                configured: 'https://twitter.com/i/lists/123456789',
                expected: false,
                description: 'ä¸»é¡µ vs åˆ—è¡¨é¡µ'
            },
            {
                current: 'https://twitter.com/search?q=bitcoin',
                configured: 'https://twitter.com/i/lists/123456789',
                expected: false,
                description: 'æœç´¢é¡µ vs åˆ—è¡¨é¡µ'
            },
            {
                current: 'https://twitter.com/username',
                configured: 'https://twitter.com/i/lists/123456789',
                expected: false,
                description: 'ç”¨æˆ·ä¸»é¡µ vs åˆ—è¡¨é¡µ'
            },
            {
                current: 'https://twitter.com/i/lists/123',
                configured: 'https://twitter.com/i/lists/123456789',
                expected: false,
                description: 'éƒ¨åˆ†åŒ¹é…çš„åˆ—è¡¨ID'
            },
            {
                current: 'https://twitter.com/username/lists/listname',
                configured: 'https://twitter.com/username/lists/othername',
                expected: false,
                description: 'ä¸åŒçš„ç”¨æˆ·åˆ—è¡¨å'
            },
            {
                current: 'https://facebook.com/groups/123456789',
                configured: 'https://twitter.com/i/lists/123456789',
                expected: false,
                description: 'å®Œå…¨ä¸åŒçš„ç½‘ç«™'
            }
        ];

        function runTests() {
            const resultsContainer = document.getElementById('testResults');
            let passCount = 0;
            let totalCount = testCases.length;

            testCases.forEach((testCase, index) => {
                const result = isUrlMatch(testCase.current, testCase.configured);
                const passed = result === testCase.expected;
                
                if (passed) passCount++;

                const testDiv = document.createElement('div');
                testDiv.className = `test-case ${passed ? 'pass' : 'fail'}`;
                testDiv.innerHTML = `
                    <div class="test-input">
                        <strong>å½“å‰URL:</strong> ${testCase.current}<br>
                        <strong>é…ç½®URL:</strong> ${testCase.configured}<br>
                        <strong>æè¿°:</strong> ${testCase.description}
                    </div>
                    <div class="test-result ${passed ? 'pass' : 'fail'}">
                        ${passed ? 'âœ… é€šè¿‡' : 'âŒ å¤±è´¥'} - 
                        æœŸæœ›: ${testCase.expected}, å®é™…: ${result}
                    </div>
                `;
                resultsContainer.appendChild(testDiv);
            });

            // æ˜¾ç¤ºæ€»ç»“
            const summary = document.getElementById('summary');
            const summaryText = document.getElementById('summaryText');
            summary.style.display = 'block';
            summaryText.innerHTML = `
                <strong>æµ‹è¯•å®Œæˆ!</strong><br>
                é€šè¿‡: ${passCount}/${totalCount} (${Math.round(passCount/totalCount*100)}%)
            `;
        }

        function testManual() {
            const currentUrl = document.getElementById('currentUrl').value;
            const configuredUrl = document.getElementById('configuredUrl').value;
            const resultDiv = document.getElementById('manualResult');

            if (!currentUrl || !configuredUrl) {
                resultDiv.innerHTML = '<span style="color: #e0245e;">è¯·è¾“å…¥ä¸¤ä¸ªURL</span>';
                return;
            }

            const result = isUrlMatch(currentUrl, configuredUrl);
            resultDiv.innerHTML = `
                <strong>åŒ¹é…ç»“æœ:</strong> 
                <span style="color: ${result ? '#17bf63' : '#e0245e'};">
                    ${result ? 'âœ… åŒ¹é…' : 'âŒ ä¸åŒ¹é…'}
                </span>
            `;
        }

        // é¡µé¢åŠ è½½æ—¶è¿è¡Œæµ‹è¯•
        document.addEventListener('DOMContentLoaded', runTests);
    </script>
</body>
</html> 